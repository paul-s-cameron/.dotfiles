- defaults:
    link:
      force: true
      create: true
      relink: true
    shell:
      stderr: true

- clean:
    ~/:
      force: true
    ~/.config:
      recursive: true

- shell:
    - [if ! hash yay 2>/dev/null; then sudo pacman -S --needed git base-devel && git clone https://aur.archlinux.org/yay.git && cd yay && makepkg -si && cd .. && rm -r yay; fi, Installing yay]
    - [yay -S --needed --noconfirm - < ~/.dotfiles/packages, Installing packages]
    - [sh pre-install.sh, Running pre installation script]

- create:
    - ~/Downloads
    - ~/Wallpapers
    - ~/Pictures
    - ~/Videos
    - ~/.oh-my-zsh/custom/
    - ~/.oh-my-zsh/custom/plugins
    - ~/.config/Vencord/
    - ~/.config/systemd/user/
    - ~/.local/share/rofi

- link:
    ~/.local/share/rofi/themes/:
        glob: true
        path: themes/rofi/*
    ~/.config/:
        glob: true
        path: config/*
    ~/.config/Mullvad VPN/gui_settings.json: Mullvad/gui_settings.json
    ~/.config/systemd/user/hyprpanel.service: services/hyprpanel.service
    ~/.config/Vencord/settings: Vencord/settings
    ~/.config/Vencord/themes: Vencord/themes
    ~/.config/Vencord/vencord-settings.json: Vencord/vencord-settings.json
    ~/.oh-my-zsh/custom/alias.zsh: oh-my-zsh/custom/alias.zsh
    ~/.oh-my-zsh/custom/themes/powerlevel10k: oh-my-zsh/custom/themes/powerlevel10k
    ~/.oh-my-zsh/custom/plugins/zsh-autosuggestions: oh-my-zsh/custom/plugins/zsh-autosuggestions/
    ~/.oh-my-zsh/custom/plugins/zsh-completions: oh-my-zsh/custom/plugins/zsh-completions/
    ~/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting: oh-my-zsh/custom/plugins/zsh-syntax-highlighting/
    ~/.zshrc: zshrc
    ~/.zshrc_local_after: zshrc_local_after
    ~/.scripts: scripts
    ~/.p10k.zsh: p10k.zsh
    ~/.gitconfig: gitconfig

- shell:
    - [chmod +x -R ~/.scripts, Authorizing scripts]
    - [git submodule update --init --recursive, Installing submodules]
    - [systemctl --user enable --now hyprpolkitagent, Enabling hyrpolkitagent service]
    - [systemctl --user enable --now hypridle, Enabling hypridle service]
    - [systemctl --user enable --now hyprpanel, Enabling hypridle service]
    - [systemctl enable --now jackett, Enabling jackett service]